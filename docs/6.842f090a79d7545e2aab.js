(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{pKmL:function(t,e,r){"use strict";r.r(e),r.d(e,"CoreModule",function(){return A});var s=r("ofXK"),n=r("tyNb"),i=r("fXoL"),c=r("tI6t"),o=r("pLZG"),a=r("RmnQ"),u=r("l7P3"),p=r("b1Ni"),l=r("7zfz"),d=r("fqaE"),h=r("wxlm"),b=r("Wq6t"),m=r("jIHw");function f(t,e){1&t&&i.Nb(0,"img",3)}function g(t,e){if(1&t&&i.Nb(0,"p-chip",10),2&t){const t=i.bc(2);i.hc("label",t.username)}}function C(t,e){1&t&&i.Nb(0,"p-chip",11)}function v(t,e){if(1&t){const t=i.Tb();i.Sb(0,"p-splitButton",12),i.Zb("onClick",function(){return i.uc(t),i.bc(2).logout()}),i.Rb()}if(2&t){const t=i.bc(2);i.hc("model",t.items1)}}function I(t,e){1&t&&i.Nb(0,"button",13)}const S=function(){return["/carts"]};function y(t,e){if(1&t&&(i.Sb(0,"div",4),i.Nb(1,"i",5),i.Ac(2,g,1,1,"p-chip",6),i.Ac(3,C,1,0,"p-chip",7),i.Ac(4,v,1,1,"p-splitButton",8),i.Ac(5,I,1,0,"button",9),i.Rb()),2&t){const t=i.bc();i.Bb(1),i.hc("value",t.countProducts)("routerLink",i.jc(6,S)),i.Bb(1),i.hc("ngIf",t.username),i.Bb(1),i.hc("ngIf",!t.username),i.Bb(1),i.hc("ngIf",t.username),i.Bb(1),i.hc("ngIf",!t.username)}}let L=(()=>{class t{constructor(t,e){this.authService=t,this.store=e}ngOnInit(){this.getItems(),this.getCountProducts(),this.authSubscrition=this.store.select("auth").pipe(Object(o.a)(t=>null!=t.user)).subscribe(t=>{this.username=t.user.username,console.log(this.username)})}ngOnDestroy(){this.authSubscrition.unsubscribe()}logout(){this.authService.logout()}getCountProducts(){this.store.select("cartProducts").subscribe(t=>{this.countProducts=0===t.products.length?0:t.products.length})}getItems(){this.items=[{label:"Home",icon:"pi pi-home",routerLink:"home"},{label:"Products",icon:"pi pi-apple",routerLink:"products"},{label:"Carts",icon:"pi pi-shopping-cart",routerLink:"carts"},{label:"Orders",icon:"pi pi-chart-bar",routerLink:"orders"}],this.items1=[{label:"Profile",icon:"pi pi-user"}]}}return t.\u0275fac=function(e){return new(e||t)(i.Mb(a.a),i.Mb(u.h))},t.\u0275cmp=i.Gb({type:t,selectors:[["app-menu-bar"]],decls:3,vars:1,consts:[[3,"model"],["pTemplate","start"],["pTemplate","end"],["src","assets/showcase/images/logo.jpg","height","40",1,"p-mr-2"],[1,"p-d-flex","p-ac-center"],["pBadge","",1,"pi","pi-shopping-cart","p-text-secondary",2,"font-size","2rem","cursor","pointer",3,"value","routerLink"],["icon","pi pi-user","class","p-ml-6 p-mt-1 p-mr-2",3,"label",4,"ngIf"],["label","not logged in","icon","pi pi-user-minus","class","p-ml-6 p-mt-1 p-mr-2",4,"ngIf"],["label","Sign off","icon","pi pi-sign-out","styleClass","p-button-secondary",3,"model","onClick",4,"ngIf"],["pButton","","pRipple","","type","button","routerLink","/auth/login","label","LogIn","class","p-button-outlined",4,"ngIf"],["icon","pi pi-user",1,"p-ml-6","p-mt-1","p-mr-2",3,"label"],["label","not logged in","icon","pi pi-user-minus",1,"p-ml-6","p-mt-1","p-mr-2"],["label","Sign off","icon","pi pi-sign-out","styleClass","p-button-secondary",3,"model","onClick"],["pButton","","pRipple","","type","button","routerLink","/auth/login","label","LogIn",1,"p-button-outlined"]],template:function(t,e){1&t&&(i.Sb(0,"p-menubar",0),i.Ac(1,f,1,0,"ng-template",1),i.Ac(2,y,6,7,"ng-template",2),i.Rb()),2&t&&i.hc("model",e.items)},directives:[p.a,l.h,d.a,n.b,s.k,h.a,b.a,m.b],styles:[""]}),t})();var w=r("QIUk");let j=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Gb({type:t,selectors:[["app-footer"]],decls:3,vars:0,consts:[[1,"p-m-1"],[1,"p-d-flex","p-jc-center"]],template:function(t,e){1&t&&(i.Sb(0,"p-card",0),i.Sb(1,"div",1),i.Cc(2," Shopping cart 2021 - Prueba tul "),i.Rb(),i.Rb())},directives:[w.a],styles:[""]}),t})(),k=(()=>{class t{constructor(t){this.cartService=t}ngOnInit(){this.cartService.initCartsListener(),this.cartService.getListCarts()}}return t.\u0275fac=function(e){return new(e||t)(i.Mb(c.a))},t.\u0275cmp=i.Gb({type:t,selectors:[["app-core"]],decls:5,vars:0,consts:[[1,"p-d-flex","p-flex-column","p-jc-center","p-flex-wrap"],[1,"p-as-center","p-ac-center"],[1,"p-mb-6"]],template:function(t,e){1&t&&(i.Sb(0,"div",0),i.Sb(1,"div",1),i.Nb(2,"app-menu-bar",2),i.Nb(3,"router-outlet"),i.Nb(4,"app-footer"),i.Rb(),i.Rb())},directives:[L,n.f,j],styles:[""]}),t})(),O=(()=>{class t{constructor(t){this.authService=t}canLoad(){return this.authService.isAuth()}}return t.\u0275fac=function(e){return new(e||t)(i.Wb(a.a))},t.\u0275prov=i.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const P=[{path:"",component:k,children:[{path:"home",loadChildren:()=>Promise.all([r.e(1),r.e(9)]).then(r.bind(null,"ct+p")).then(t=>t.HomeModule)},{path:"products",loadChildren:()=>Promise.all([r.e(1),r.e(11)]).then(r.bind(null,"WLUK")).then(t=>t.ProductsModule)},{path:"carts",loadChildren:()=>r.e(8).then(r.bind(null,"TgVI")).then(t=>t.CartsModule),canLoad:[O]},{path:"orders",loadChildren:()=>r.e(10).then(r.bind(null,"h9W5")).then(t=>t.OrdersModule),canLoad:[O]},{path:"**",redirectTo:"home"}]}];let R=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Kb({type:t}),t.\u0275inj=i.Jb({imports:[[n.e.forChild(P)],n.e]}),t})();var B=r("5Ovr");let N=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Kb({type:t}),t.\u0275inj=i.Jb({imports:[[s.b,n.e,B.a]]}),t})(),A=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Kb({type:t}),t.\u0275inj=i.Jb({imports:[[s.b,R,N]]}),t})()},tI6t:function(t,e,r){"use strict";r.d(e,"a",function(){return d});var s=r("IpTe"),n=r("We3V"),i=r("pLZG"),c=r("lJxs"),o=r("quSY"),a=r("fXoL"),u=r("l7P3"),p=r("I/3d"),l=r("RmnQ");let d=(()=>{class t{constructor(t,e,r){this.store=t,this.af=e,this.authService=r,this.cartsItemsSubscription=new o.a,this.cartsListernetSubcription=new o.a,this.url="https://shopping-cart-708cb-default-rtdb.firebaseio.com/",this.products=[],this.carts=[]}addCart(t){const e=this.authService.getUser();this.af.doc(`${e.uid}/Cart/`).collection("products").add(Object.assign({},t))}initCartsListener(){this.cartsListernetSubcription=this.store.select("auth").pipe(Object(i.a)(t=>null!=t.user)).subscribe(t=>this.cartCurrentItems(t.user.uid))}cartCurrentItems(t){this.cartsItemsSubscription=this.af.collection(`${t}/Cart/products`).snapshotChanges().pipe(Object(c.a)(t=>t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data())))).subscribe(t=>{this.store.dispatch(new s.d(t))})}deleteProductCart(t){const e=this.authService.getUser();return this.af.doc(`${e.uid}/Cart/products/${t.id}`).delete()}deleteCart(){const t=this.authService.getUser();this.store.select("cartProducts").subscribe(t=>{this.products=t.products}),this.products.forEach(e=>{this.af.doc(`${t.uid}/Cart/products/${e.id}`).delete()})}ordeCart(t){return this.orderAddCart(t)}orderAddCart(t){const e=this.authService.getUser();return this.cart={id:e.uid,products:t,quantity:t.length,state:!1},this.af.doc(`${e.uid}/order/`).collection("carts").add(Object.assign({},this.cart))}getListCarts(){return this.store.select("auth").pipe(Object(i.a)(t=>null!=t.user)).subscribe(t=>{this.af.collection(`${t.user.uid}/order/carts`).snapshotChanges().pipe(Object(c.a)(t=>t.map(t=>Object.assign({id:t.payload.doc.id},t.payload.doc.data())))).subscribe(t=>{this.carts=t,this.store.dispatch(new n.b(t))})})}listCarts(){return this.carts}}return t.\u0275fac=function(e){return new(e||t)(a.Wb(u.h),a.Wb(p.a),a.Wb(l.a))},t.\u0275prov=a.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);